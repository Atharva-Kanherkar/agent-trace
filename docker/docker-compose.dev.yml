services:
  dashboard:
    volumes:
      - ..:/app
      - dashboard_node_modules:/app/node_modules
    command: >
      bash -lc "npm ci &&
      npm run --workspace @agent-trace/dashboard build &&
      node packages/dashboard/dist/src/cli.js"

  collector:
    volumes:
      - ..:/app
      - collector_node_modules:/app/node_modules
    command: >
      bash -lc "npm ci &&
      npm run --workspace @agent-trace/runtime build &&
      node packages/runtime/dist/src/cli.js"

  api:
    volumes:
      - ..:/app
      - api_node_modules:/app/node_modules
    command: >
      bash -lc "npm ci &&
      npm run --workspace @agent-trace/runtime build &&
      node packages/runtime/dist/src/cli.js"

volumes:
  dashboard_node_modules:
  collector_node_modules:
  api_node_modules:
